<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet"
        href="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/select2/dist/css/select2.min.css">
    <link rel="stylesheet" href="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/node-waves/waves.css">
    <link rel="stylesheet" href="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/jquery-ui/jquery-ui.min.css">
    <link rel="stylesheet" href="https://siga.arcoconsultoria.com/SIGA/libsiga/css/style.min.css">
    <link rel="stylesheet" href="https://siga.arcoconsultoria.com/SIGA/libsiga/css/main.css">
    <link rel="stylesheet" href="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/datatables/datatables.min.css">
    <link rel="stylesheet" href="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/bootstrap/css/bootstrap5Min.css">
    <title>Cadastro de Associado</title>
    <style>
        label {
            display: block;
            border-radius: 5px;
        }

        html {
            overflow-y: hidden;
        }

        .div-input {
            margin: 15px;
        }

        .radio {
            margin-right: 5px !important;
        }

        .form-control:focus {
            box-shadow: none;
            border-top: none;
            border-left: none;
            border-right: none;
        }

        .form-control {
            box-shadow: none;
            border-top: none;
            border-left: none;
            border-right: none;
        }

        input {
            font-size: 80% !important;
        }

        .tel {
            margin-right: 7px;
        }

        .obg {
            color: red !important;
            margin-left: 3px;
        }

        #header {
            padding: 0 !important;
        }

        #nav-ul {
            list-style-type: none;
        }

        #nav-ul li {
            display: inline;
            border: solid 1px rgba(179, 179, 179, 0.781);
            padding: 0 5px;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
        }

        .act {
            border-bottom: none !important;
        }

        #nav-ul li:first-child {
            margin-left: -5.5%;
        }

        #nav-ul a {
            color: black;
            text-decoration: none;
        }
    </style>
</head>

<body>

    <div class="container">
        <div class="justify-content-center m-t-5 col-12">
            <div class="card col-10">
                <div class="row" id="header">
                    <div class="col-7" style="display: inline;">
                        <ul id="nav-ul">
                            <li role="presentation" class="tab-select act" id="pagina_cad">
                                <a href="#pagina_cadastro" data-toggle="tab" onclick="alterTab(0)">
                                    Cadastrar
                                </a>
                            </li>
                            <li role="presentation" class="tab-select" id="aba_dbbancario">
                                <a href="#pagina_dbancarios" data-toggle="tab" onclick="alterTab(1)">
                                    Dados Bancarios
                                </a>
                            </li>

                            <li role="presentation" class="tab-select" id="aba_mont_cat">
                                <a href="#pagina_mont_cat" data-toggle="tab" onclick="alterTab(2)">
                                    Sinistro
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="col-5" style="margin-top: 5px; display: inline;">
                        <input type="text" placeholder="CPF/CNPJ do Associado" id="input-busca"
                            onkeypress="return event.charCode >= 48 && event.charCode <= 57"
                            style="display: inline; border: solid 1px lightgray; border-radius: 5px; height: 30px; margin-top: 3px;">
                        <button class="btn btn-success" style="margin-left: 5px;" onclick="buscaAss()">Buscar</button>
                        <button class="btn btn-success" onclick="novoAss()">Adicionar</button>
                    </div>
                </div>
                <div class="tab-pane row" id="pagina_cadastro">
                    <div id="left" class="col-6">
                        <div class="div-input form-floating mb-3">
                            <input class="form-control" type="text" autocomplete="off" id="associado"
                                placeholder="Nome do Associado" style="width: 400px;">
                            <label for="">Nome do Associado<span class="obg">*</span></label>
                        </div>
                        <div class="div-input">
                            <div class="col-4">
                                <label for="" style="margin-left: 12px;">Tipo <span class="obg">*</span></label>
                                <input type="radio" name="cpf-cnpj" id="cpf" class="radio"
                                    style="margin-left: 10px; margin-right: 5px;"
                                    onclick="alterarCpf_cnpj(1,'cpf_cnpj')"><span style="font-size: 75%;">CPF</span>
                                <input type="radio" name="cpf-cnpj" id="cnpj" class="radio"
                                    style="margin-left: 10px; margin-right: 5px;"
                                    onclick="alterarCpf_cnpj(2,'cpf_cnpj')"><span style="font-size: 75%;">CNPJ</span>
                            </div>
                            <div class="form-floating mb-3 m-t-10">
                                <input class="form-control" type="text" autocomplete="off" id="cpf_cnpj" placeholder="."
                                    maxlength="" onfocusout="formatar('cpf_cnpj')"
                                    onkeypress="return event.charCode >= 48 && event.charCode <= 57">
                                <label for="">CPF/CNPJ<span class="obg">*</span></label>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="div-input form-floating mb-3 col-5" style="display: inline-block;">
                                <input class="form-control" type="text" autocomplete="off" name="cep" id="cep"
                                    placeholder="32604-158" maxlength="8" style="width: 210px;"
                                    onfocusout="formataCEP()">
                                <label for="" id="">CEP</label>
                            </div>
                            <div class="div-input mb-3 col-5" style="display: inline-block;">
                                <select class="form-select" aria-label="Default select example" id="uf">
                                    <option value="" selected>UF</option>
                                    <option value="AC">Acre</option>
                                    <option value="AL">Alagoas</option>
                                    <option value="AP">Amapá</option>
                                    <option value="AM">Amazonas</option>
                                    <option value="BA">Bahia</option>
                                    <option value="CE">Ceará</option>
                                    <option value="DF">Distrito Federal</option>
                                    <option value="ES">Espirito Santo</option>
                                    <option value="GO">Goiás</option>
                                    <option value="MA">Maranhão</option>
                                    <option value="MS">Mato Grosso do Sul</option>
                                    <option value="MT">Mato Grosso</option>
                                    <option value="MG">Minas Gerais</option>
                                    <option value="PA">Pará</option>
                                    <option value="PB">Paraíba</option>
                                    <option value="PR">Paraná</option>
                                    <option value="PE">Pernambuco</option>
                                    <option value="PI">Piauí</option>
                                    <option value="RJ">Rio de Janeiro</option>
                                    <option value="RN">Rio Grande do Norte</option>
                                    <option value="RS">Rio Grande do Sul</option>
                                    <option value="RO">Rondônia</option>
                                    <option value="RR">Roraima</option>
                                    <option value="SC">Santa Catarina</option>
                                    <option value="SP">São Paulo</option>
                                    <option value="SE">Sergipe</option>
                                    <option value="TO">Tocantins</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="div-input form-floating mb-3 col-7" style="display: inline-block;">
                                <input class="form-control" type="text" autocomplete="off" name="Endereco" id="endereco"
                                    placeholder="Rua José da Conceição">
                                <label for="" id="" style="width: 400px;">Endereço</label>
                            </div>
                            <div class="div-input form-floating mb-3 col-3" style="display: inline-block;">
                                <input class="form-control" type="text" autocomplete="off" name="num" id="num"
                                    placeholder="Rua José da Conceição">
                                <label for="" id="" style="width: 150px;">Número</label>
                            </div>
                        </div>
                        <div class="div-input form-floating mb-3 col-12">
                            <div class="col-5 form-floating mb-3" style="display: inline-block;">
                                <input class="form-control" type="text" autocomplete="off" name="bairro" id="bairro"
                                    placeholder="Angola">
                                <label for="" id="">Bairro</label>
                            </div>
                            <div class="col-5 form-floating mb-3" style="display: inline-block;">
                                <input class="form-control" type="text" autocomplete="off" name="Cidade" id="cidade"
                                    placeholder="Betim">
                                <label for="" id="">Cidade</label>
                            </div>
                        </div>
                        <div class="div-input form-floating mb-3">
                            <input class="form-control" type="text" autocomplete="off" name="" id="associacao" readonly
                                value="associação">
                            <label for="" id="">Empresa</label>
                        </div>
                    </div>
                    <div id="right" class="col-6">
                        <div class="div-input">
                            <div class="col-12">
                                <div class="form-floating mb-3 tel" style="display: inline-block;">
                                    <input class="form-control form-cel" type="text" autocomplete="off" name="" id="sms"
                                        onfocusout="formataTel(0)" placeholder="(31) 9 9999-9999" style="width: 130px;">
                                    <label for="" id="">Telefone 1<span class="obg">*</span></label>
                                </div>
                                <div class="form-floating mb-3 tel" style="display: inline-block;">
                                    <input class="form-control form-cel" type="text" autocomplete="off" name=""
                                        id="tel2" onfocusout="formataTel(1)" placeholder="(31) 9 9999-9999"
                                        style="width: 130px;">
                                    <label for="" id="">Telefone 2</label>
                                </div>
                                <div class="form-floating mb-3 tel" style="display: inline-block;">
                                    <input class="form-control form-cel" type="text" autocomplete="off" name=""
                                        id="tel3" onfocusout="formataTel(2)" placeholder="(31) 9 9999-9999"
                                        style="width: 130px;">
                                    <label for="" id="">Telefone 3</label>
                                </div>
                            </div>
                        </div>
                        <div class="div-input justify-content-center">
                            <div class="form-floating mb-3 col-12" style="display: inline-block;">
                                <input class="form-control" type="text" autocomplete="off" name="" id="email"
                                    placeholder="exemplo@exemplo.com" onfocusout="validateEmail()">
                                <label for="" id="">E-mail<span class="obg">*</span></label>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="div-input form-floating mb-3 col-4" style="display: inline-block;">
                                <input class="form-control" type="date" name="Endereco" id="data_nasc"
                                    placeholder="00/00/0000">
                                <label for="" id="" style="width: 400px;">Data de Nascimento<span
                                        class="obg">*</span></label>
                            </div>
                            <div style="display: inline-block;" class="col-5">
                                <label for="" style="margin-left: 5px;">Sexo<span class="obg">*</span></label>
                                <input type="radio" name="sexo" id="masc" class="radio"
                                    style="margin-left: -2px; margin-right: 2px;"><span
                                    style="font-size: 75%;">Masculino</span><br>
                                <input type="radio" name="sexo" id="fem" class="radio"
                                    style="margin-left: -2px; margin-right: 2px;"><span
                                    style="font-size: 75%;">Feminino</span>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="div-input form-floating mb-3 col-4" style="display: inline-block;">
                                <input class="form-control" type="text" autocomplete="off" id="cnh"
                                    placeholder="36902051223" style="width: 150px;">
                                <label for="">CNH</label>
                            </div>
                            <div class="div-input form-floating mb-3 col-5" style="display: inline-block;">
                                <input class="form-control" type="date" id="data_cnh" placeholder="00/00/0000">
                                <label for="">Data Validade CNH</label>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="div-input form-floating mb-3 col-4" style="display: inline-block;">
                                <input class="form-control" type="text" autocomplete="off" id="rg"
                                    placeholder="28.131.342-8" style="width: 150px;" onfocusout="formataRG()">
                                <label for="">RG</label>
                            </div>
                            <div class="div-input form-floating mb-3 col-6" style="display: inline-block;">
                                <input class="form-control" type="text" readonly id="usuario" placeholder="usuário">
                                <label style="margin-left: 10px;">Usuário</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane row" id="dados_bancarios" style="display: none;">
                    <div class="div-input col-12">
                        <div class="col-2" style="margin-left: 14.2%;">
                            <label for="">Tipo de conta</label>
                            <select class="form-select" aria-label="Default select example" id="sConta"
                                style="font-size: 10pt; box-shadow: none;">
                                <option value="" selected></option>
                                <option value="1">Corrente</option>
                                <option value="2">Poupança</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-9" style="margin: 0 auto;">
                        <div class="div-input form-floating mb-3 col-7 d-inline-block">
                            <input class="form-control" type="text" autocomplete="off" id="banco"
                                placeholder="Joaquin Pereira" style="width: 400px;">
                            <label for="">Banco</label>
                        </div>
                        <div class="div-input form-floating mb-3 col-3 d-inline-block">
                            <input class="form-control" type="text" autocomplete="off" id="agencia"
                                placeholder="Joaquin Pereira" style="width: 200px;">
                            <label for="">Agencia</label>
                        </div>
                    </div>
                    <div class="col-9" style="margin: 0 auto;">
                        <div class="div-input form-floating mb-3 col-7 d-inline-block">
                            <input class="form-control" type="text" autocomplete="off" id="responsavel"
                                placeholder="Joaquin Pereira" style="width: 400px;">
                            <label for="">Responsável</label>
                        </div>
                        <div class="div-input form-floating mb-3 col-3 d-inline-block">
                            <input class="form-control" type="text" autocomplete="off" id="conta"
                                placeholder="Joaquin Pereira" style="width: 200px;">
                            <label for="">Conta</label>
                        </div>
                    </div>
                    <div class="div-input col-11 justify-content-center">
                        <div class="col-2" style="display: inline-block; margin-left: 15px;">
                            <label for="" style="margin-left: 12px;">Tipo</label>
                            <input type="radio" name="cpf-cnpj_dado" id="cpf_dado" class="radio"
                                style="margin-left: 10px; margin-right: 5px;"
                                onclick="alterarCpf_cnpj_2(1,'cpf_cnpj_Dbanco')"><span
                                style="font-size: 75%;">CPF</span>
                            <input type="radio" name="cpf-cnpj_dado" id="cnpj_dado" class="radio"
                                style="margin-left: 10px; margin-right: 5px;"
                                onclick="alterarCpf_cnpj_2(2,'cpf_cnpj_Dbanco')"><span
                                style="font-size: 75%;">CNPJ</span>
                        </div>
                        <div class="form-floating mb-3 m-t-10 col-7" style="display: inline-block; width: 500px;">
                            <input class="form-control" type="text" autocomplete="off" id="cpf_cnpj_Dbanco"
                                placeholder="123.456.789-99" maxlength="" onfocusout="formatar_2('cpf_cnpj_Dbanco')"
                                onkeypress="return event.charCode >= 48 && event.charCode <= 57">
                            <label for="">CPF/CNPJ</label>
                        </div>
                    </div>
                </div>
                <div class="tab-pane row" id="sinistro" style="display: none;">
                    <div class="div-input col-12">
                        <div class="table col-12">
                            <table class="table" id="table_sinistro" style="width:95%">
                                <thead>
                                    <tr>
                                        <th class="th_table align-center"></th>
                                        <th class="th_table align-center">Sinistro</th>
                                        <th class="th_table align-center">Data Abertuda</th>
                                        <th class="th_table align-center">Veículo</th>
                                        <th class="th_table align-center">Cobertura</th>
                                        <th class="th_table align-center">Ano</th>
                                        <th class="th_table align-center">Placa</th>
                                        <th class="th_table align-center">Tipo Evento</th>
                                        <th class="th_table align-center">Evento Relacionado</th>
                                        <th class="th_table align-center">Oficina</th>
                                        <th class="th_table align-center">Nome</th>
                                </thead>
                                <tbody class="scrollable" id="body_table">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col-1" style="position: absolute; bottom: 8px; right: 100px;">
                    <button class="btn btn-danger" id="btn-deletar" onclick="apagarAss()">Deletar</button>
                </div>
                <div class="col-1" style="position: absolute; bottom: 8px; right: 10px;">
                    <button class="btn btn-success" id="btn-salvar" onclick="obterDados()">Salvar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        window.onload = () => {
            buscaAss(0);
        }

        /* Função para criar um novo usuário */

        function novoAss() {
            document.getElementById('associado').value = '';
            document.getElementById('cpf_cnpj').value = '';
            document.getElementById('endereco').value = '';
            document.getElementById('num').value = '';
            document.getElementById('bairro').value = '';
            document.getElementById('cidade').value = '';
            document.getElementById('uf').value = '';
            document.getElementById('cep').value = '';
            document.getElementById('sms').value = '';
            document.getElementById('tel2').value = '';
            document.getElementById('tel3').value = '';
            document.getElementById('email').value = '';
            document.getElementById('data_nasc').value = '';
            document.getElementById('cnh').value = '';
            document.getElementById('data_cnh').value = '';
            document.getElementById('rg').value = '';
            document.getElementById('sConta').value = '';
            document.getElementById('banco').value = '';
            document.getElementById('agencia').value = '';
            document.getElementById('conta').value = '';
            document.getElementById('responsavel').value = '';
            document.getElementById('associacao').value = '';
            document.getElementById('usuario').value = '';
            document.getElementById('cpf_cnpj_Dbanco').value = '';
            document.getElementById('cpf_dado').checked = 0
            document.getElementById('cnpj_dado').checked = 0
            document.getElementById('cpf').checked = 0
            document.getElementById('cnpj').checked = 0
            document.getElementById('masc').checked = 0
            document.getElementById('fem').checked = 0
            j('#table_sinistro').DataTable().clear();
            j('#table_sinistro').DataTable().rows().invalidate().draw();
            j('#table_sinistro').DataTable().destroy();
            validacaoEmail = false;
            assID = null;
        }

        /* Função para excluir Associado */

        function apagarAss() {
            if (assID == null) {
                novoAss();
            }
            else {
                parent.ebfFlowExecute('Novo cadastro de associados - SweetAlert', parent.ebfListParamsCreate(assID));
            }
        }

        /* Consulta se o cpf/cnpj ja existe no banco */

        function verificaCpfCnpj(cpf_cnpj) {
            let retorno = parent.ebfFlowExecute('Novo cadastro de associados - verificar cpf_cnpj associado', parent.ebfListParamsCreate(cpf_cnpj));
            if (retorno) {
                buscaAss(cpf_cnpj);
            }
        }

        /* Cadastrar - formatar cpf/cnpj */

        var cpf_ou_cnpj;

        function alterarCpf_cnpj(tipo, id) {
            if (tipo == 1) {
                document.getElementById(`${id}`).setAttribute('maxlength', '14')
                document.getElementById(`${id}`).value = ''
            }
            else {
                document.getElementById(`${id}`).setAttribute('maxlength', '18')
                document.getElementById(`${id}`).value = ''
            }
            cpf_ou_cnpj = tipo;
        }

        var validacaoCpfCnpj = false

        function formatar(id) {
            let valor = document.getElementById(`${id}`).value;
            valor = valor.replace(/\./g, '')
            valor = valor.replace(/-/g, '')
            valor = valor.replace(/\//g, '')
            valor = valor.replace(/ /g, '')
            if (valor.length == 11 && cpf_ou_cnpj == 1 && isValidCPF(`${valor}`)) {
                formataCPF(id);
                document.getElementById(`${id}`).style.border = ''
                validacaoCpfCnpj = true
            }
            else if (valor.length == 14 && cpf_ou_cnpj == 2) {
                formataCNPJ(id);
                document.getElementById(`${id}`).style.border = ''
                validacaoCpfCnpj = true
            }
            else {
                document.getElementById(`${id}`).style.border = 'red solid 1px'
                validacaoCpfCnpj = false
            }
        }

        function formataCPF(id) {
            let valor = document.getElementById(`${id}`).value
            valor = valor.replace(/\./g, '')
            valor = valor.replace(/-/g, '')
            valor = valor.replace(/\//g, '')
            valor = valor.replace(/ /g, '')
            valor = valor.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, "$1.$2.$3-$4")
            document.getElementById(`${id}`).value = valor;
            sig_ass_tipo = 1;
            verificaCpfCnpj(valor);
        }

        function formataCNPJ(id) {
            let valor = document.getElementById(`${id}`).value
            valor = valor.replace(/\./g, '')
            valor = valor.replace(/-/g, '')
            valor = valor.replace(/\//g, '')
            valor = valor.replace(/ /g, '')
            valor = valor.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/, "$1.$2.$3\/$4-$5")
            document.getElementById(`${id}`).value = valor;
            sig_ass_tipo = 2;
            verificaCpfCnpj(valor);
        }

        /* Dados Bancarios - formatar cpf/cnpj */

        var cpf_ou_cnpj_2;

        function alterarCpf_cnpj_2(tipo, id) {
            if (tipo == 1) {
                document.getElementById(`${id}`).setAttribute('maxlength', '14')
                document.getElementById(`${id}`).value = ''
            }
            else {
                document.getElementById(`${id}`).setAttribute('maxlength', '18')
                document.getElementById(`${id}`).value = ''
            }
            cpf_ou_cnpj_2 = tipo;
        }

        function formatar_2(id) {
            let valor = document.getElementById(`${id}`).value;
            valor = valor.replace(/\./g, '')
            valor = valor.replace(/-/g, '')
            valor = valor.replace(/\//g, '')
            valor = valor.replace(/ /g, '')
            if (valor.length == 11 && cpf_ou_cnpj_2 == 1) {
                formataCPF_2(id);
                document.getElementById(`${id}`).style.border = ''
            }
            else if (valor.length == 14 && cpf_ou_cnpj_2 == 2) {
                formataCNPJ_2(id);
                document.getElementById(`${id}`).style.border = ''
            }
            else {
                document.getElementById(`${id}`).style.border = 'red solid 1px'
            }
        }

        function formataCPF_2(id) {
            let valor = document.getElementById(`${id}`).value
            valor = valor.replace(/\./g, '')
            valor = valor.replace(/-/g, '')
            valor = valor.replace(/\//g, '')
            valor = valor.replace(/ /g, '')
            valor = valor.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, "$1.$2.$3-$4")
            document.getElementById(`${id}`).value = valor;
        }

        function formataCNPJ_2(id) {
            let valor = document.getElementById(`${id}`).value
            valor = valor.replace(/\./g, '')
            valor = valor.replace(/-/g, '')
            valor = valor.replace(/\//g, '')
            valor = valor.replace(/ /g, '')
            valor = valor.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/, "$1.$2.$3\/$4-$5")
            document.getElementById(`${id}`).value = valor;
        }

        /* Outras formatações */

        function formataCEP() {
            let valor = document.getElementById('cep').value
            if (valor.length == 8) {
                viaCep(valor);
                valor = valor.replace(/(\d{5})(\d{3})/, "$1-$2")
                document.getElementById('cep').value = valor;
            }
        }

        function formataTel(local) {
            let cel = document.querySelectorAll('.form-cel')[local].value;
            cel = cel.replace(/(\d{2})(\d{1})(\d{4})(\d{4})/, "($1) $2 $3-$4")
            document.querySelectorAll('.form-cel')[local].value = cel
        }

        function formataRG(input) {
            if (input == null || input == undefined) {
                let valor = document.getElementById('rg').value
                if (valor.length == 9) {
                    valor = valor.replace(/(\d{2})(\d{3})(\d{3})(\d{1})/, "$1.$2.$3-$4")
                    document.getElementById('rg').value = valor;
                }
            }
            else {
                return input.replace(/(\d{2})(\d{3})(\d{3})(\d{1})/, "$1.$2.$3-$4")
            }
        }

        /* Validação de email */

        var validacaoEmail = false

        function validateEmail() {
            let email = document.getElementById('email').value;
            var re = /\S+@\S+\.\S+/;
            let teste = re.test(email);
            if (teste) {
                document.getElementById('email').style.border = '';
                validacaoEmail = true;
            }
            else {
                document.getElementById('email').style.border = 'red solid 1px';
                validacaoEmail = false;
            }
        }

        /* Consulta cep e traz dados sobre */

        function viaCep(cep) {
            fetch(`https://viacep.com.br/ws/${cep}/json`)
                .then(response => {
                    return response.json()
                        .then((data) => {
                            document.getElementById('cidade').value = data.localidade
                            document.getElementById('bairro').value = data.bairro
                            document.getElementById('endereco').value = data.logradouro
                            document.getElementById('uf').value = data.uf
                        });
                }).then((data) => {
                }).catch((err) => { });
        }

        /* alterados de abas */

        function alterTab(tab) {
            let qnt = document.querySelectorAll('.tab-pane').length
            for (let i = 0; i < qnt; i++) {
                document.querySelectorAll('.tab-pane')[i].style.display = 'none'
                if (document.querySelectorAll('.tab-select')[i].classList.contains('act')) {
                    document.querySelectorAll('.tab-select')[i].classList.remove('act')
                }
            }
            document.getElementById('btn-salvar').style.display = ''
            document.getElementById('btn-deletar').style.display = ''
            document.querySelectorAll('.tab-pane')[tab].style.display = ''
            document.querySelectorAll('.tab-select')[tab].classList.add('act')
            if (tab == 2) {
                j('#table_sinistro').DataTable().columns.adjust();
                document.getElementById('btn-salvar').style.display = 'none'
                document.getElementById('btn-deletar').style.display = 'none'
            }
        }

        /* obtenção de dados */

        function obtemSexo() {
            let teste1 = document.getElementById('masc').checked
            let teste2 = document.getElementById('fem').checked

            if (teste1) {
                sexo = 1
            }
            else if (teste2) {
                sexo = 2
            }
            if (teste1 || teste2) {
                return true
            }
            else {
                return false
            }
        }

        var sexo = 0;
        var sig_ass_tipo
        function obterDados() {
            let nome = document.getElementById('associado').value;
            let cpf_cnpj = document.getElementById('cpf_cnpj').value;
            let sms = document.getElementById('sms').value;
            let email = document.getElementById('email').value;
            let data_nasc = document.getElementById('data_nasc').value
            if (
                nome != null &&
                cpf_cnpj != null &&
                obtemSexo() &&
                sms != null &&
                validacaoEmail &&
                data_nasc != null
            ) {
                let cep = document.getElementById('cep').value;
                let endereco = document.getElementById('endereco').value;
                let bairro = document.getElementById('bairro').value;
                let num = document.getElementById('num').value;
                let cnh = document.getElementById('cnh').value;
                let tel2 = document.getElementById('tel2').value;
                let tel3 = document.getElementById('tel3').value;
                let data_cnh = document.getElementById('data_cnh').value;
                let rg = document.getElementById('rg').value;
                let uf = document.getElementById('uf').value;
                endereco = `${endereco},${num}`
                let tipo_conta = document.getElementById('sConta').value;
                let banco = document.getElementById('banco').value;
                let agencia = document.getElementById('agencia').value;
                let responsavel = document.getElementById('responsavel').value;
                let conta = document.getElementById('conta').value;
                let cpf_cnpj_dado = document.getElementById('cpf_cnpj_Dbanco').value
                let cidade = document.getElementById('cidade').value
                cadastraAss(nome, cpf_cnpj, sms, email, sexo, data_nasc, cep, endereco, bairro, cnh, tel2, tel3, data_cnh, rg, uf, tipo_conta, banco, agencia, responsavel, conta, cpf_cnpj_dado, cidade)
            }
            else {

                parent.ebfFlowExecute('sweetAlert Notificar', parent.ebfListParamsCreate(0, 'Preencha os campos obrigatórios antes de salvar!'));
                console.log(nome, cpf_cnpj, sexo, sms, email)
            }
        }

        function cadastraAss(nome, cpf_cnpj, sms, email, sexo, data_nasc, cep, endereco, bairro, cnh, tel2, tel3, data_cnh, rg, uf, tipo_conta, banco, agencia, responsavel, conta, cpf_cnpj_dado, cidade) {
            let lista = [nome, cpf_cnpj, sms, email, sexo, data_nasc, cep, endereco, bairro, cnh, tel2, tel3, data_cnh, rg, uf, tipo_conta, banco, agencia, responsavel, conta, cpf_cnpj_dado, sig_ass_tipo, cidade]
            parent.ebfFlowExecute('Novo cadastro de associados - salvar dados', parent.ebfListParamsCreate(lista, assID));
        }

        /* Buscar associado */
        var assID;
        function buscaAss(filtro) {
            if (filtro == null || filtro == undefined) {
                let valor = document.getElementById('input-busca').value;
                valor = valor.replace(/\./g, '')
                valor = valor.replace(/-/g, '')
                valor = valor.replace(/\//g, '')
                valor = valor.replace(/ /g, '')
                if (valor.length == 11) {
                    valor = valor.replace(/\./g, '')
                    valor = valor.replace(/-/g, '')
                    valor = valor.replace(/\//g, '')
                    valor = valor.replace(/ /g, '')
                    valor = valor.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, "$1.$2.$3-$4")
                }
                else if (valor.length == 14) {
                    valor = valor.replace(/\./g, '')
                    valor = valor.replace(/-/g, '')
                    valor = valor.replace(/\//g, '')
                    valor = valor.replace(/ /g, '')
                    valor = valor.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/, "$1.$2.$3\/$4-$5")
                }
                var retorno = parent.ebfFlowExecute('Novo cadastro de associados - filtrar', parent.ebfListParamsCreate(valor));
            }
            else {
                var retorno = parent.ebfFlowExecute('Novo cadastro de associados - filtrar', parent.ebfListParamsCreate(filtro));
            }
            if (retorno != null && retorno != undefined) {
                preencherRetorno(retorno);
            }
            else {
                assID = null;
                validacaoEmail = false;
                sig_ass_tipo = null;
                parent.ebfFlowExecute('sweetAlert Notificar', parent.ebfListParamsCreate(0, 'Associado não encontrado!'))
            }
        }

        function obterEndereco_Numero(tipo, valor) {
            if (valor != null && valor != undefined) {
                let lista = valor.split(',');
                /* tipo == 0 Endereço */
                /* tipo == 1 Numero */
                return lista[tipo];
            }
            else
                return null
        }

        function preencherSexo(sexo) {
            if (sexo == 1) {
                document.getElementById('masc').checked = 1
            }
            else if (sexo == 2) {
                document.getElementById('fem').checked = 1;
            }
        }

        /* Caso o retorno do banco não seja nulo ou vazio essa função e chamada passando o retorno como parametro
        ela pega os dados e preenche os campos */

        function preencherRetorno(lista) {
            assID = lista[0];
            document.getElementById('associado').value = lista[1];
            if (lista[2].length == 14) {
                document.getElementById('cpf').checked = 1
                sig_ass_tipo = 1
            }
            else if (lista[2].length == 18) {
                document.getElementById('cnpj').check = 1
                sig_ass_tipo = 2
            }
            document.getElementById('cpf_cnpj').value = lista[2];
            document.getElementById('endereco').value = obterEndereco_Numero(0, lista[3]);
            document.getElementById('num').value = obterEndereco_Numero(1, lista[3]);
            document.getElementById('bairro').value = lista[4];
            document.getElementById('cidade').value = lista[5];
            document.getElementById('uf').value = lista[6];
            document.getElementById('cep').value = lista[7].replace(/(\d{5})(\d{3})/, "$1-$2");
            document.getElementById('sms').value = lista[8];
            document.getElementById('tel2').value = lista[9];
            document.getElementById('tel3').value = lista[10];
            document.getElementById('email').value = lista[11];
            preencherSexo(lista[12]);
            document.getElementById('data_nasc').value = lista[13];
            document.getElementById('cnh').value = lista[14];
            document.getElementById('data_cnh').value = lista[15];
            document.getElementById('rg').value = formataRG(lista[16]);
            document.getElementById('sConta').value = lista[17];
            document.getElementById('banco').value = lista[18];
            document.getElementById('agencia').value = lista[19];
            document.getElementById('conta').value = lista[20];
            document.getElementById('responsavel').value = lista[21];
            document.getElementById('associacao').value = lista[22];
            document.getElementById('usuario').value = lista[23];
            document.getElementById('cpf_cnpj_Dbanco').value = lista[24];
            if (lista[24].length == 14) {
                document.getElementById('cpf_dado').checked = 1
            }
            else if (lista[24].length == 18) {
                document.getElementById('cnpj_dado').check = 1
            }
            validacaoEmail = true;
        }


        function isValidCPF(cpf) {
            // Validar se é String
            if (typeof cpf !== 'string') return false

            // Tirar formatação
            cpf = cpf.replace(/[^\d]+/g, '')

            // Validar se tem tamanho 11 ou se é uma sequência de digitos repetidos
            if (cpf.length !== 11 || !!cpf.match(/(\d)\1{10}/)) return false

            // String para Array
            cpf = cpf.split('')

            const validator = cpf
                // Pegar os últimos 2 digitos de validação
                .filter((digit, index, array) => index >= array.length - 2 && digit)
                // Transformar digitos em números
                .map(el => +el)

            const toValidate = pop => cpf
                // Pegar Array de items para validar
                .filter((digit, index, array) => index < array.length - pop && digit)
                // Transformar digitos em números
                .map(el => +el)

            const rest = (count, pop) => (toValidate(pop)
                // Calcular Soma dos digitos e multiplicar por 10
                .reduce((soma, el, i) => soma + el * (count - i), 0) * 10)
                // Pegar o resto por 11
                % 11
                // transformar de 10 para 0
                % 10

            return !(rest(10, 2) !== validator[0] || rest(11, 1) !== validator[1])
        }

    </script>
    <!-- Jquery Core Js -->
    <script src="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap Core Js -->
    <script src="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/bootstrap/js/bootstrap.js"></script>

    <!-- Fusioncharts Js -->
    <script src="https://siga.arcoconsultoria.com/SIGA/FC/fusioncharts.js"></script>
    <script src="https://siga.arcoconsultoria.com/SIGA/FC/fusioncharts.charts.js"></script>
    <script src="https://siga.arcoconsultoria.com/SIGA/FC/themes/fusioncharts.theme.fint.js"></script>

    <script type="text/javascript"
        src="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/moment/moment.js"></script>
    <script type="text/javascript"
        src="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/datatables/datatables.min.js"></script>
    <script type="text/javascript"
        src="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/datatables/dt-moment.js"></script>
    <script type="text/javascript"
        src="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/datatables/Buttons-1.6.1/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript"
        src="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/datatables/Buttons-1.6.1/js/buttons.flash.min.js"></script>
    <script type="text/javascript"
        src="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/datatables/jszip.min.js"></script>
    <script type="text/javascript"
        src="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/datatables/pdfmake.min.js"></script>
    <script type="text/javascript"
        src="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/datatables/vfs_fonts.js"></script>
    <script type="text/javascript"
        src="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/datatables/Buttons-1.6.1/js/buttons.html5.min.js"></script>
    <script type="text/javascript"
        src="https://siga.arcoconsultoria.com/SIGA/libsiga/plugins/datatables/Buttons-1.6.1/js/buttons.print.min.js"></script>
    <script type="text/javascript" src="https://siga.arcoconsultoria.com/SIGA/libsiga/js/mainNoConflict.js"></script>
</body>

</html>